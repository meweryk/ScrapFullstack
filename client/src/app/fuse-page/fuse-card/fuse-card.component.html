<div class="page-title" style="padding: 0;">
  <h5>
    <a routerLink="/fuse">Выплавка</a>
    <i class="tiny material-icons">keyboard_arrow_right</i>
    <span style="font-size: 1.2rem;">{{isNew ? 'Добавить плавку': 'Редактировать плавку '}}
      {{fusepl}}</span>
  </h5>
  <span>
    <button *ngIf="!isNew" class="btn btn-small red" (click)="deleteFuse()">
      <i class="material-icons">delete</i>
    </button>
  </span>
</div>

<div class="row" style="margin-bottom: 5px">
  <a #dropdown class="dropdown-trigger" data-target="dropdownFuse" style="color: #333333">
    <i class="small material-icons center">list</i>
  </a>
  <ul id='dropdownFuse' class='dropdown-content'>
    <li><a (click)="onAddFuseId()"><i class="tiny material-icons right">keyboard_arrow_right</i>Идентификатор плавки</a>
    </li>
    <li class="divider" tabindex="-1"></li>
    <li><a class="active" href="#test2"><i class="tiny material-icons right">keyboard_arrow_right</i>Расчёт массы
        шихты</a></li>
    <li class="divider" tabindex="-1"></li>
    <li><a href="#test3"><i class="tiny material-icons right">keyboard_arrow_right</i>Шихтовые материалы</a></li>
    <li class="divider" tabindex="-1"></li>
    <li><a href="#test4"><i class="tiny material-icons right">keyboard_arrow_right</i>Расчёт ферросплавов</a></li>
  </ul>
</div>

<div class="row" *ngIf="fuse">
  <div class="col s12 m6">
    <div class="card grey lighten-2 z-depth-3">
      <div class="card-content grey-text text-darken-3">
        <span class="card-title">Идентификатор Павки</span>
        <ul>
          <li><b class="smallText">Дата</b> {{fuseD}}</li>
          <li><b class="smallText">Плавильная карта</b> {{fuse.fuseCard}}</li>
          <li><b class="smallText">Плавка</b> {{fuse.fuse}}</li>
          <li><b class="smallText">Марка стали</b> {{fuse.alloy}}</li>
        </ul>
      </div>
    </div>
  </div>
</div>


<div class="col s12">
  <form class="col s12 m6" [formGroup]="form" (ngSubmit)="onSubmit()">
    <div class="modal card-position" #modalId>
      <div class="modal-content">
        <h4 class="mb1">Идентификатор плавки</h4>
        <div class="row">
          <div class="input-field">
            <input formControlName="fuse" id="fuse" type="text"
              [ngClass]="{'invalid': form.get('fuse').invalid && form.get('fuse').touched}">
            <label for="fuse">Номер плавки</label>
            <span class="helper-text red-text" *ngIf="form.get('fuse').invalid && form.get('fuse').touched">
              <span *ngIf="form.get('fuse').errors['required']">
                Номер плавки не может быть пустым.
              </span>
            </span>
          </div>
          <div class="input-field">
            <input formControlName="fuseDate" id="fuseDate" type="text" #start
              [ngClass]="{'invalid': form.get('fuseDate').invalid && form.get('fuseDate').touched}">
            <label for="fuseDate">Дата плавки</label>
            <span class="helper-text red-text" *ngIf="form.get('fuseDate').invalid && form.get('fuseDate').touched">
              <span *ngIf="form.get('fuseDate').errors['required']">
                Дата не может быть пустой.
              </span>
            </span>
          </div>
          <div class="input-field">
            <input formControlName="fuseCard" id="fuseCard" type="text">
            <label for="fuseCard">Номер плавильной карты</label>
            <span class="helper-text red-text" *ngIf="form.get('fuseCard').invalid && form.get('fuseCard').touched">
              <span *ngIf="form.get('fuseCard').errors['required']">
                Введите номер плавильной карты, поле не может быть пустым.
              </span>
            </span>
          </div>
          <div class="input-field">
            <input formControlName="alloy" id="alloy" type="text"
              [ngClass]="{'invalid': form.get('alloy').invalid && form.get('alloy').touched}">
            <label for="fuseCard">Марка стали</label>
            <span class="helper-text red-text" *ngIf="form.get('alloy').invalid && form.get('alloy').touched">
              <span *ngIf="form.get('alloy').errors['required']">
                Введите марку выплавляемой стали, поле не может быть пустым.
              </span>
            </span>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="waves-effect waves-light btn btn-small" [disabled]="open" (click)="changeSetting()"><i
            class="material-icons">edit</i></button>
        <button type="button" (click)="onCancel()"
          class="modal-action waves-effect waves-black btn-flat">Отмена</button>
        <button type="submit" [disabled]="form.invalid || form.disabled"
          class="waves-effect waves-light btn-small right">
          <span><i class="material-icons">save</i></span>
        </button>
      </div>
    </div>
  </form>
</div>
